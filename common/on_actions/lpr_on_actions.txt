# ============================================================================
# ON ACTIONS - MONTHLY EVENT SYSTEM
# ============================================================================
# This file hooks into the monthly country pulse to trigger LPR events.
# Every month, each country:
# 1. Receives a builder event (100% chance) to accumulate LPR points
# 2. Checks if any LPR variable has reached 12 points (finisher threshold)
#
# The 100% chance is intentional for testing/guaranteed gameplay, but can
# be adjusted to a lower percentage for more random event timing.
# ============================================================================

# Fires every month for each country
on_monthly_pulse_country = {
	# Builder events - 100% chance per month (guaranteed for consistent gameplay)
	# Players always get a monthly choice to accumulate LPR points
	random_events = {
		chance_to_happen = 100
		1 = lpr_events.1
	}
	
	# Binary choice events - 100% chance when variables >= 5
	# Note: Multiple binary events can trigger in the same month if multiple
	# variables are >= 5. This is intentional for testing purposes.
	
	# Liberty binary event (triggers when Liberty >= 5)
	random_events = {
		chance_to_happen = 100
		trigger = {
			var:actionables_lpr_liberty >= 5
		}
		1 = lpr_events.binary.1
	}
	
	# Progress binary event (triggers when Progress >= 5)
	random_events = {
		chance_to_happen = 100
		trigger = {
			var:actionables_lpr_progress >= 5
		}
		1 = lpr_events.binary.2
	}
	
	# Revolution binary event (triggers when Revolution >= 5)
	random_events = {
		chance_to_happen = 100
		trigger = {
			var:actionables_lpr_revolution >= 5
		}
		1 = lpr_events.binary.3
	}
	
	# Big Finisher Binary Events - trigger when variables >= 20
	# These provide major rewards for consuming accumulated points
	
	# Liberty big finisher binary event (triggers when Liberty >= 20)
	random_events = {
		chance_to_happen = 100
		trigger = {
			var:actionables_lpr_liberty >= 20
		}
		1 = lpr_events.big_finisher.1
	}
	
	# Progress big finisher binary event (triggers when Progress >= 20)
	random_events = {
		chance_to_happen = 100
		trigger = {
			var:actionables_lpr_progress >= 20
		}
		1 = lpr_events.big_finisher.2
	}
	
	# Revolution big finisher binary event (triggers when Revolution >= 20)
	random_events = {
		chance_to_happen = 100
		trigger = {
			var:actionables_lpr_revolution >= 20
		}
		1 = lpr_events.big_finisher.3
	}
	
	# Check for finisher events every month (triggers if conditions met)
	# This evaluates if any LPR variable (Liberty, Progress, or Revolution)
	# has reached the threshold of 12 points, triggering a finisher event
	effect = {
		lpr_check_finisher_events = yes
	}
	
	# Spent Threshold Events - trigger when cumulative spent variables reach milestones
	# These events fire once per threshold (100, 200, 300) for each LPR path
	# Flags prevent events from firing multiple times
	
	# Liberty spent threshold events
	random_events = {
		chance_to_happen = 100
		trigger = {
			var:actionables_lpr_liberty_spent >= 100
			NOT = { has_country_flag = lpr_liberty_spent_100_triggered }
		}
		1 = lpr_events.spent_liberty.100
	}
	
	random_events = {
		chance_to_happen = 100
		trigger = {
			var:actionables_lpr_liberty_spent >= 200
			NOT = { has_country_flag = lpr_liberty_spent_200_triggered }
		}
		1 = lpr_events.spent_liberty.200
	}
	
	random_events = {
		chance_to_happen = 100
		trigger = {
			var:actionables_lpr_liberty_spent >= 300
			NOT = { has_country_flag = lpr_liberty_spent_300_triggered }
		}
		1 = lpr_events.spent_liberty.300
	}
	
	# Progress spent threshold events
	random_events = {
		chance_to_happen = 100
		trigger = {
			var:actionables_lpr_progress_spent >= 100
			NOT = { has_country_flag = lpr_progress_spent_100_triggered }
		}
		1 = lpr_events.spent_progress.100
	}
	
	random_events = {
		chance_to_happen = 100
		trigger = {
			var:actionables_lpr_progress_spent >= 200
			NOT = { has_country_flag = lpr_progress_spent_200_triggered }
		}
		1 = lpr_events.spent_progress.200
	}
	
	random_events = {
		chance_to_happen = 100
		trigger = {
			var:actionables_lpr_progress_spent >= 300
			NOT = { has_country_flag = lpr_progress_spent_300_triggered }
		}
		1 = lpr_events.spent_progress.300
	}
	
	# Revolution spent threshold events
	random_events = {
		chance_to_happen = 100
		trigger = {
			var:actionables_lpr_revolution_spent >= 100
			NOT = { has_country_flag = lpr_revolution_spent_100_triggered }
		}
		1 = lpr_events.spent_revolution.100
	}
	
	random_events = {
		chance_to_happen = 100
		trigger = {
			var:actionables_lpr_revolution_spent >= 200
			NOT = { has_country_flag = lpr_revolution_spent_200_triggered }
		}
		1 = lpr_events.spent_revolution.200
	}
	
	random_events = {
		chance_to_happen = 100
		trigger = {
			var:actionables_lpr_revolution_spent >= 300
			NOT = { has_country_flag = lpr_revolution_spent_300_triggered }
		}
		1 = lpr_events.spent_revolution.300
	}
}